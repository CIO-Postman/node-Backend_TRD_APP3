UPDATE S 
SET VAL_PER_WAH = N.VAL_PER_WAH
FROM( 
    SELECT*
    FROM TDASSET_FORMER.tdadmin.BETW_NS3K
    WHERE BRANCH_CODE = @BRANCH_CODE
    AND NS3K_RN = @NS3K_RN
    ) AS S
LEFT OUTER JOIN ( 
  SELECT *
         FROM TDASSET_FORMER.tdadmin.PARCEL_47_NS3K_16
         WHERE 1=1
         AND BRANCH_CODE = @BRANCH_CODE
         AND NS3K_RN = @NS3K_RN   
 --     AND CHANOD_NO IS NULL
         )AS N
ON  S.BRANCH_CODE = @BRANCH_CODE
AND S.NS3K_RN = @NS3K_RN    

SELECT BRANCH_CODE, NS3K_RN, VAL_PER_WAH
    FROM TDASSET_FORMER.tdadmin.BETW_NS3K
    WHERE BRANCH_CODE = @BRANCH_CODE
    AND NS3K_RN = @NS3K_RN
    AND CHANGWAT_CODE = @CHANGWAT_CODE